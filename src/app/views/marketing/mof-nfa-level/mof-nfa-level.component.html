<div class="mof-container">
  <!-- Header -->
  <div class="header">
    <button mat-icon-button class="back-button" (click)="goBack()" *ngIf="showDetail">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h2 class="header-title">{{ showDetail ? 'MOF NFA Level Authorization' : 'Pending MOF NFA Level (' + mofList.length + ')' }}</h2>
    <button mat-icon-button class="refresh-button" (click)="refresh()" *ngIf="!showDetail">
      <mat-icon>refresh</mat-icon>
    </button>
  </div>

  <!-- Loading Indicator -->
  <div class="loading-container" *ngIf="isLoading && !showDetail">
    <mat-spinner></mat-spinner>
  </div>

   <div *ngIf="errorMessage" class="errorModal">
    <div class="errorModal-content">
      <h2>Alert</h2>
      <p>
        {{ errorMessage }}
      </p>
      <button class="error-ok-button" (click)="clearMessages()">OK</button>
    </div>
  </div>

  <div *ngIf="successMessage" class="successModal">
    <div class="successModal_content">
      <p>{{ successMessage }}</p>
      <button class="success-ok-button" (click)="clearMessages()">OK</button>
    </div>
  </div>

   <div *ngIf="warningMessage" class="warningModal">
    <div class="warningModal_content">
      <p>{{ warningMessage }}</p>
      <button class="warning-ok-button" (click)="clearMessages()">OK</button>
    </div>
  </div>

  <!-- MOF List View -->
   <div class="mof-list" *ngIf="!showDetail && !isLoading">
    <mat-card *ngFor="let mof of mofList; let i = index" class="mof-card" (click)="onCardClick(mof)">
      <mat-card-content>
        <!-- Card Number -->
        <div class="card-number">{{ i + 1 }}</div>

        <!-- Row 1: MOF NO and DATE -->
        <div class="mof-row">
          <div class="mof-field-group">
            <span class="field-label">MOF NO</span>
            <span class="field-value field-value-bold">{{ mof.mofNo }}</span>
          </div>
          <div class="mof-field-group">
            <span class="field-label">DATE</span>
            <span class="field-value">{{ mof.date }}</span>
          </div>
        </div>

        <!-- Row 2: BRANCH and Branch Name -->
        <div class="mof-row">
          <div class="mof-field-group">
            <span class="field-label">BRANCH</span>
            <!-- <span class="field-value branch-number">{{ mof.branchNumber }}</span> -->
          </div>
          <div class="mof-field-group">
            <span class="field-value">{{ mof.branch }}</span>
          </div>
        </div>

        <!-- Row 3: KVA and PH -->
        <div class="mof-row">
          <div class="mof-field-group">
            <span class="field-label">KVA</span>
            <span class="field-value">{{ mof.kva }}</span>
          </div>
          <div class="mof-field-group">
            <span class="field-label">PH</span>
            <span class="field-value">{{ mof.ph }}</span>
          </div>
        </div>

        <!-- Row 4: MODEL and PANEL -->
        <div class="mof-row">
          <div class="mof-field-group">
            <span class="field-label">MODEL</span>
            <span class="field-value">{{ mof.model }}</span>
          </div>
          <div class="mof-field-group">
            <span class="field-label">PANEL</span>
            <span class="field-value">{{ mof.panel }}</span>
          </div>
        </div>

        <!-- Row 5: INDENTOR NAME and CUSTOMER NAME -->
        <div class="mof-row">
          <div class="mof-field-group">
            <span class="field-label">INDENTOR NAME</span>
            <span class="field-value">{{ mof.indentorName }}</span>
          </div>
          <div class="mof-field-group">
            <span class="field-label">CUSTOMER NAME</span>
            <span class="field-value">{{ mof.customerName }}</span>
          </div>
        </div>

        <!-- Row 6: ORDERBY (Full Width) -->
        <div class="mof-row">
          <div class="mof-field-group mof-field-full">
            <span class="field-label">ORDERBY</span>
            <span class="field-value">{{ mof.orderedBy }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- MOF Detail View -->
  <div class="mof-detail" *ngIf="showDetail && selectedMof">
    <div class="detail-content">
      <!-- Three Column Header -->
      <div class="detail-row three-col">
        <div class="detail-field">
          <span class="detail-label">MOF No</span>
          <span class="detail-value">{{ selectedMof.mofNo }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Branch</span>
          <span class="detail-value">{{ selectedMof.branch }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">OrderTaken By</span>
          <span class="detail-value">{{ selectedMof.orderTakenBy }}</span>
        </div>
      </div>

      <!-- Two Column Row -->
      <div class="detail-row two-col">
        <div class="detail-field">
          <span class="detail-label">Indentor Name</span>
          <span class="detail-value">{{ selectedMof.indentorName }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Customer Name</span>
          <span class="detail-value">{{ selectedMof.customerName }}</span>
        </div>
      </div>

      <!-- Three Column Row -->
      <div class="detail-row three-col">
        <div class="detail-field">
          <span class="detail-label">KVA</span>
          <span class="detail-value">{{ selectedMof.kva }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">GIA Model</span>
          <span class="detail-value">{{ selectedMof.gia }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Panel</span>
          <span class="detail-value">{{ selectedMof.panel }}</span>
        </div>
      </div>

      <!-- Four Column Row -->
      <div class="detail-row four-col">
        <div class="detail-field">
          <span class="detail-label">Basic Rate</span>
          <span class="detail-value">{{ selectedMof.basicRate }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Mkt PLust</span>
          <span class="detail-value">{{ selectedMof.mktPLust }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Actual Amt</span>
          <span class="detail-value">{{ selectedMof.actualAmt }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Diff</span>
          <span class="detail-value">{{ selectedMof.diff }}</span>
        </div>
      </div>

      <!-- BOM Section -->
      <div class="detail-row two-col">
        <div class="detail-field">
          <span class="detail-label">BOM</span>
          <span class="detail-value">{{ selectedMof.bomDg }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">DG BOM Amt</span>
          <span class="detail-value">{{ selectedMof.dgBomAmt }}</span>
        </div>
      </div>

      <div class="detail-row two-col">
        <div class="detail-field">
          <span class="detail-label">CP BOM Amt</span>
          <span class="detail-value">{{ selectedMof.cpBomAmt }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">Total BOM Amt</span>
          <span class="detail-value">{{ selectedMof.totalBomAmt }}</span>
        </div>
      </div>

      <!-- NFA Section -->
      <div class="detail-row two-col">
        <div class="detail-field">
          <span class="detail-label">NFA No</span>
          <span class="detail-value">{{ selectedMof.nfaNo }}</span>
        </div>
      </div>

      <!-- Five Column Row -->
      <div class="detail-row five-col">
        <div class="detail-field">
          <span class="detail-label">Qty</span>
          <span class="detail-value">{{ selectedMof.qty }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">BalQty</span>
          <span class="detail-value">{{ selectedMof.balQty }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">KOELAmt</span>
          <span class="detail-value">{{ selectedMof.koelAmt }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">KALAAmt</span>
          <span class="detail-value">{{ selectedMof.kalaAmt }}</span>
        </div>
        <div class="detail-field">
          <span class="detail-label">OtherAmt</span>
          <span class="detail-value">{{ selectedMof.otherAmt }}</span>
        </div>
      </div>

      <!-- Remarks Section -->
      <div class="detail-row full-width">
        <div class="detail-field">
          <span class="detail-label">MOF Remark</span>
          <span class="detail-value remark-text">{{ selectedMof.mofRemark }}</span>
        </div>
      </div>

      <div class="detail-row full-width">
        <div class="detail-field">
          <span class="detail-label">HOD Level Remark</span>
          <span class="detail-value remark-text">{{ selectedMof.hodLevelRemark }}</span>
        </div>
      </div>

      <div class="detail-row full-width">
        <div class="detail-field">
          <span class="detail-label">QIA Level Remark</span>
          <span class="detail-value remark-text">{{ selectedMof.qiaLevelRemark }}</span>
        </div>
      </div>

      <!-- <div class="detail-row full-width">
        <div class="detail-field">
          <span class="detail-label">NFA Level Remark</span>
          <span class="detail-value remark-text">{{ selectedMof.nfaLevelRemark }}</span>
        </div>
      </div> -->
      <div class="detail-row full-width">
        <div class="detail-field">
          <span class="detail-label">NFA Level Remark</span>
          <textarea
            class="remark-input"
            [(ngModel)]="nfaRemark"
            placeholder="Enter NFA Level Remark..."
            rows="2">
          </textarea>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button mat-raised-button class="btn-hold" (click)="onHold()">HOLD</button>
      <button mat-raised-button class="btn-auth" (click)="onAuth()">AUTH</button>
    </div>
  </div>
</div>
